(()=>{"use strict";const t={email:null,accessToken:null,refreshTokens:async function(){const t={method:"POST",credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json;charset=UTF-8"}};try{let e=await fetch("api/v1/refresh",t);if(!e.ok)throw this.logout(),"Токен не валиден(ответ сервера: ".concat(e.status,")");let n=await e.json();if(console.log("Полученный json (refresh_request):"),console.log(n),n.access)return this.accessToken=n.access,this.email=n.email,!0}catch(t){console.error("ошибка при рефреше (refresh_request): "+t)}},logout(){try{this.accessToken=null,this.email=null,document.cookie="refresh=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",v("#/")}catch(t){console.error("ошибка при логауте: "+t)}}};class e{constructor(t){this.id=document.getElementById(t)}renderComponent(t){this.id.innerHTML=t}}function n(t){return""===t.value?(t.nextElementSibling.innerText="Поле не должно быть пустым",t.classList.add("error-input"),!1):(t.nextElementSibling.innerText="",t.classList.remove("error-input"),!0)}function o(t){const e=/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/,n=/^(?=.*?[a-z])(?=.*?[0-9]).{8,}$/;let o,s;switch(t.name){case"email":o=e.test(t.value),s="Введите корректный e-mail";break;case"password":o=n.test(t.value),s="Необходимо минимум 8 символов, 1 латинская буква и 1 цифра";break;case"repeat-password":o=t.value===t.closest(".form").querySelector('input[name="password"]').value,s="Пароли не совпадают";break;case"consent-checkbox":o=t.checked,s="Необходимо согласиться с условиями"}return o||""==t.value?(t.nextElementSibling.innerText="",t.classList.remove("error-input"),!0):(t.nextElementSibling.innerText=s,t.classList.add("error-input"),!1)}const s=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:'<li class="nav__item"><a class="button--main" href="#/panel">Панель управления</a></li>',n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:'<li><a class="dropdown__link" href="#/settings">Настройки</a></li>';const o='\n    <nav class="nav header__nav">\n      <ul class="nav__list">\n        '.concat(e,'\n        <li class="nav__item">\n          <div class="dropdown">\n            <a class="dropdown__button nav__link" href="#">').concat(t.email,'</a>\n            <ul class="dropdown__list">\n              ').concat(n,'\n              <li><a class="dropdown__link logout-link" href="#">Выйти</a></li>\n            </ul>\n          </div>\n        </li>\n      </ul>\n    </nav>\n    <button class="burger">\n      <span class="burger__line"></span>\n    </button>\n  ');return o},r=new e("user-header-section"),l=new e("hero-section"),a=new e("modals-section"),i=new e("additional-section");async function c(){t.accessToken?(r.renderComponent(s(t)),l.renderComponent('\n\t<div class="hero__body">\n\t  <h1 class="hero__title">Расширенная версия сокращения ссылки!</h1>\n\t\t<form class="hero__form form" id="shortener-form" action="#" method="post" autocomplete="off">\n\t\t\t<div class="form__input-wrapper form__input-wrapper--long-link">\n\t\t\t\t<label class="form__label form__label--long-link" for="long-link">\n\t\t\t\t\t<input class="form__input form__input--long-link" id="long-link" type="url" name="longLink" placeholder="Введите ссылку для сокращения" required>\n\t\t\t\t\t<span class="error-label"></span>\n\t\t\t\t</label>\n\t\t\t\t<button class="form__button shortener-button shortener-button--submit" id="shortener-submitBtn" type="submit" name="submit">\n\t\t\t\t<svg width="25" height="23" viewBox="0 0 25 23" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t<path d="M10.25 5.17677C10.25 4.1529 9.94942 3.15203 9.38628 2.30071C8.82314 1.4494 8.02272 0.785877 7.08625 0.39406C6.14978 0.00224309 5.11932 -0.100274 4.12516 0.0994724C3.13101 0.299219 2.21782 0.792259 1.50108 1.51624C0.784336 2.24023 0.296227 3.16264 0.0984777 4.16683C-0.0992715 5.17103 0.00222053 6.2119 0.39012 7.15783C0.778019 8.10376 1.4349 8.91226 2.2777 9.48109C3.12051 10.0499 4.11137 10.3535 5.125 10.3535C6.40389 10.3503 7.63483 9.86154 8.57361 8.98429L11.1111 11.351L11.1278 11.3636L11.1222 11.3678L8.57222 13.743C7.63417 12.8655 6.40354 12.3767 5.125 12.3737C4.11137 12.3737 3.12051 12.6773 2.2777 13.2462C1.4349 13.815 0.778019 14.6235 0.39012 15.5694C0.00222053 16.5154 -0.0992715 17.5562 0.0984777 18.5604C0.296227 19.5646 0.784336 20.487 1.50108 21.211C2.21782 21.935 3.13101 22.4281 4.12516 22.6278C5.11932 22.8275 6.14978 22.725 7.08625 22.3332C8.02272 21.9414 8.82314 21.2779 9.38628 20.4266C9.94942 19.5752 10.25 18.5744 10.25 17.5505C10.25 17.1338 10.1889 16.734 10.0958 16.3468L14.0458 13.5536L19.7778 17.8535C22.85 20.0267 25 16.9234 25 16.9234L10.0958 6.38047C10.1875 5.99327 10.25 5.59343 10.25 5.17677ZM5.125 7.70202C4.7967 7.70202 4.47161 7.6367 4.16829 7.5098C3.86498 7.38289 3.58938 7.19688 3.35723 6.96239C3.12509 6.7279 2.94094 6.44952 2.8153 6.14314C2.68967 5.83676 2.625 5.50839 2.625 5.17677C2.625 4.84515 2.68967 4.51677 2.8153 4.2104C2.94094 3.90402 3.12509 3.62564 3.35723 3.39115C3.58938 3.15665 3.86498 2.97065 4.16829 2.84374C4.47161 2.71683 4.7967 2.65152 5.125 2.65152C5.78804 2.65152 6.42393 2.91757 6.89277 3.39115C7.36161 3.86472 7.625 4.50703 7.625 5.17677C7.625 5.84651 7.36161 6.48881 6.89277 6.96239C6.42393 7.43597 5.78804 7.70202 5.125 7.70202ZM5.125 20.0758C4.46196 20.0758 3.82608 19.8097 3.35723 19.3361C2.88839 18.8625 2.625 18.2202 2.625 17.5505C2.625 16.8808 2.88839 16.2385 3.35723 15.7649C3.82608 15.2913 4.46196 15.0252 5.125 15.0252C5.78804 15.0252 6.42393 15.2913 6.89277 15.7649C7.36161 16.2385 7.625 16.8808 7.625 17.5505C7.625 18.2202 7.36161 18.8625 6.89277 19.3361C6.42393 19.8097 5.78804 20.0758 5.125 20.0758ZM25 5.80528C25 5.80528 22.85 2.70202 19.7778 4.87514L15.3264 8.01066L18.5958 10.3227L25 5.80528Z"/>\n\t\t\t\t</svg>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<div class="form__input-wrapper form__input-wrapper--short-link">\n\t\t\t\t<h2 class="hero__short-link-title visually-hidden">Ваша короткая ссылка:</h2>\n\t\t\t\t<label class="form__label form__label--short-link" for="short-link">\n\t\t\t\t\t<input class="form__input form__input--short-link short-link" id="short-link" type="url" name="shortLink" placeholder="Результат" readonly>\n\t\t\t\t</label>\n\t\t\t\t<button class="form__button shortener-button shortener-button--copy copy-button">\n\t\t\t\t<svg width="21" height="26" viewBox="0 0 21 26" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t<path d="M11.8125 0H1.3125C0.964403 0 0.630564 0.136964 0.384422 0.380761C0.138281 0.624558 0 0.955218 0 1.3V16.9C0 17.2448 0.138281 17.5754 0.384422 17.8192C0.630564 18.063 0.964403 18.2 1.3125 18.2H7.875V20.8H10.5V18.2H7.87631V15.6H10.5V13H7.875V15.6H2.625V2.6H10.5V7.8H13.125V1.3C13.125 0.955218 12.9867 0.624558 12.7406 0.380761C12.4944 0.136964 12.1606 0 11.8125 0V0ZM7.875 9.1V10.4H10.5V7.8H9.1875C8.8394 7.8 8.50556 7.93696 8.25942 8.18076C8.01328 8.42456 7.875 8.75522 7.875 9.1ZM13.125 26H15.75V23.4H13.125V26ZM13.125 10.4H15.75V7.8H13.125V10.4ZM7.875 24.7C7.875 25.0448 8.01328 25.3754 8.25942 25.6192C8.50556 25.863 8.8394 26 9.1875 26H10.5V23.4H7.875V24.7ZM19.6875 7.8H18.375V10.4H21V9.1C21 8.75522 20.8617 8.42456 20.6156 8.18076C20.3694 7.93696 20.0356 7.8 19.6875 7.8ZM18.375 26H19.6875C20.0356 26 20.3694 25.863 20.6156 25.6192C20.8617 25.3754 21 25.0448 21 24.7V23.4H18.375V26ZM18.375 15.6H21V13H18.375V15.6ZM18.375 20.8H21V18.2H18.375V20.8Z"/>\n\t\t\t\t</svg>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</form>\n\t\t<div class="hero__qr-body">\n\t\t\t<h2 class="hero__qr-title visually-hidden">QR-код вашей ссылки:</h2>\n\t\t\t<div class="hero__qr-img-wrapper qr-img-wrapper">\n\t\t\t\t<img class="hero__qr-img qr-img" id="qr" src="./img/qr.png" alt="QR-код">\n\t\t\t</div>\n\t\t</div>\n\t</div>\n  '),a.renderComponent(""),i.renderComponent("")):(r.renderComponent('\n    <nav class="nav header__nav">\n\t\t\t<ul class="nav__list">\n\t\t\t\t<li class="nav__item"><button class="nav__button button nav__button--registration modal-button" data-target="registration-modal">Зарегистрироваться</button></li>\n\t\t\t\t<li class="nav__item"><button class="nav__button button--main modal-button" data-target="login-modal">Войти</button></li>\n\t\t\t</ul>\n    </nav>\n\t\t<button class="burger">\n      <span class="burger__line"></span>\n    </button>\n  '),l.renderComponent('\n\t<div class="hero__body">\n\t\t<div class="hero__content">\n\t\t\t<h1 class="hero__title">Сократить ссылку&nbsp;&mdash; быстро и&nbsp;легко!</h1>\n\t\t\t<form class="hero__form form" id="shortener-form" action="#" method="post" autocomplete="off">\n\t\t\t\t<div class="form__input-wrapper form__input-wrapper--long-link">\n\t\t\t\t\t<label class="form__label form__label--long-link" for="long-link">\n\t\t\t\t\t\t<input class="form__input form__input--long-link" id="long-link" type="url" name="longLink" placeholder="Введите ссылку для сокращения" required>\n\t\t\t\t\t\t<span class="error-label"></span>\n\t\t\t\t\t</label>\n\t\t\t\t\t<button class="form__button shortener-button shortener-button--submit" id="shortener-submitBtn" type="submit" name="submit">\n\t\t\t\t\t<svg width="25" height="23" viewBox="0 0 25 23" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t\t<path d="M10.25 5.17677C10.25 4.1529 9.94942 3.15203 9.38628 2.30071C8.82314 1.4494 8.02272 0.785877 7.08625 0.39406C6.14978 0.00224309 5.11932 -0.100274 4.12516 0.0994724C3.13101 0.299219 2.21782 0.792259 1.50108 1.51624C0.784336 2.24023 0.296227 3.16264 0.0984777 4.16683C-0.0992715 5.17103 0.00222053 6.2119 0.39012 7.15783C0.778019 8.10376 1.4349 8.91226 2.2777 9.48109C3.12051 10.0499 4.11137 10.3535 5.125 10.3535C6.40389 10.3503 7.63483 9.86154 8.57361 8.98429L11.1111 11.351L11.1278 11.3636L11.1222 11.3678L8.57222 13.743C7.63417 12.8655 6.40354 12.3767 5.125 12.3737C4.11137 12.3737 3.12051 12.6773 2.2777 13.2462C1.4349 13.815 0.778019 14.6235 0.39012 15.5694C0.00222053 16.5154 -0.0992715 17.5562 0.0984777 18.5604C0.296227 19.5646 0.784336 20.487 1.50108 21.211C2.21782 21.935 3.13101 22.4281 4.12516 22.6278C5.11932 22.8275 6.14978 22.725 7.08625 22.3332C8.02272 21.9414 8.82314 21.2779 9.38628 20.4266C9.94942 19.5752 10.25 18.5744 10.25 17.5505C10.25 17.1338 10.1889 16.734 10.0958 16.3468L14.0458 13.5536L19.7778 17.8535C22.85 20.0267 25 16.9234 25 16.9234L10.0958 6.38047C10.1875 5.99327 10.25 5.59343 10.25 5.17677ZM5.125 7.70202C4.7967 7.70202 4.47161 7.6367 4.16829 7.5098C3.86498 7.38289 3.58938 7.19688 3.35723 6.96239C3.12509 6.7279 2.94094 6.44952 2.8153 6.14314C2.68967 5.83676 2.625 5.50839 2.625 5.17677C2.625 4.84515 2.68967 4.51677 2.8153 4.2104C2.94094 3.90402 3.12509 3.62564 3.35723 3.39115C3.58938 3.15665 3.86498 2.97065 4.16829 2.84374C4.47161 2.71683 4.7967 2.65152 5.125 2.65152C5.78804 2.65152 6.42393 2.91757 6.89277 3.39115C7.36161 3.86472 7.625 4.50703 7.625 5.17677C7.625 5.84651 7.36161 6.48881 6.89277 6.96239C6.42393 7.43597 5.78804 7.70202 5.125 7.70202ZM5.125 20.0758C4.46196 20.0758 3.82608 19.8097 3.35723 19.3361C2.88839 18.8625 2.625 18.2202 2.625 17.5505C2.625 16.8808 2.88839 16.2385 3.35723 15.7649C3.82608 15.2913 4.46196 15.0252 5.125 15.0252C5.78804 15.0252 6.42393 15.2913 6.89277 15.7649C7.36161 16.2385 7.625 16.8808 7.625 17.5505C7.625 18.2202 7.36161 18.8625 6.89277 19.3361C6.42393 19.8097 5.78804 20.0758 5.125 20.0758ZM25 5.80528C25 5.80528 22.85 2.70202 19.7778 4.87514L15.3264 8.01066L18.5958 10.3227L25 5.80528Z"/>\n\t\t\t\t\t</svg>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t\t<div class="form__input-wrapper form__input-wrapper--short-link">\n\t\t\t\t\t<h2 class="hero__short-link-title visually-hidden">Ваша короткая ссылка:</h2>\n\t\t\t\t\t<label class="form__label form__label--short-link" for="short-link">\n\t\t\t\t\t\t<input class="form__input form__input--short-link short-link" id="short-link" type="url" name="shortLink" placeholder="Результат" readonly>\n\t\t\t\t\t</label>\n\t\t\t\t\t<button class="form__button shortener-button shortener-button--copy copy-button">\n\t\t\t\t\t<svg width="21" height="26" viewBox="0 0 21 26" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t\t<path d="M11.8125 0H1.3125C0.964403 0 0.630564 0.136964 0.384422 0.380761C0.138281 0.624558 0 0.955218 0 1.3V16.9C0 17.2448 0.138281 17.5754 0.384422 17.8192C0.630564 18.063 0.964403 18.2 1.3125 18.2H7.875V20.8H10.5V18.2H7.87631V15.6H10.5V13H7.875V15.6H2.625V2.6H10.5V7.8H13.125V1.3C13.125 0.955218 12.9867 0.624558 12.7406 0.380761C12.4944 0.136964 12.1606 0 11.8125 0V0ZM7.875 9.1V10.4H10.5V7.8H9.1875C8.8394 7.8 8.50556 7.93696 8.25942 8.18076C8.01328 8.42456 7.875 8.75522 7.875 9.1ZM13.125 26H15.75V23.4H13.125V26ZM13.125 10.4H15.75V7.8H13.125V10.4ZM7.875 24.7C7.875 25.0448 8.01328 25.3754 8.25942 25.6192C8.50556 25.863 8.8394 26 9.1875 26H10.5V23.4H7.875V24.7ZM19.6875 7.8H18.375V10.4H21V9.1C21 8.75522 20.8617 8.42456 20.6156 8.18076C20.3694 7.93696 20.0356 7.8 19.6875 7.8ZM18.375 26H19.6875C20.0356 26 20.3694 25.863 20.6156 25.6192C20.8617 25.3754 21 25.0448 21 24.7V23.4H18.375V26ZM18.375 15.6H21V13H18.375V15.6ZM18.375 20.8H21V18.2H18.375V20.8Z"/>\n\t\t\t\t\t</svg>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</form>\n\t\t\t<div class="hero__qr-body">\n\t\t\t\t<h2 class="hero__qr-title visually-hidden">QR-код вашей ссылки:</h2>\n\t\t\t\t<div class="hero__qr-img-wrapper qr-img-wrapper">\n\t\t\t\t\t<img class="hero__qr-img qr-img" id="qr" src="./img/qr.png" alt="QR-код">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="hero__illustration-wrapper">\n\t\t\t<picture>\n\t\t\t\t<source srcset="./img/hero_illustration.webp" type="image/webp">\n\t\t\t\t<img class="hero__illustration" src="./img/hero_illustration.png" alt="иллюстрация">\n\t\t\t</picture>\n\t\t</div>\n\t</div>\n  '),a.renderComponent('\n\t<div class="modal" id="login-modal">\n\t\t<div class="modal__body">\n\t\t\t<div class="modal__head">\n\t\t\t\t<button class="modal__close-button"></button>\n\t\t\t</div>\n\t\t\t<div class="modal__content" id="login-section">\n\t\t\t\t<form class="hero__form form" id="login-form" action="#" method="post" autocomplete="off">\n\t\t\t\t\t<label class="form__label form__label--email" for="login-email">\n\t\t\t\t\t\t<input class="form__input form__input--email" id="login-email" type="email" name="email" placeholder="Введите e-mail" required>\n\t\t\t\t\t\t<span class="error-label"></span>\n\t\t\t\t\t</label>\n\t\t\t\t\t<label class="form__label form__label--password" for="login-password">\n\t\t\t\t\t\t<input class="form__input form__input--password" id="login-password" type="password" name="password" placeholder="Введите пароль" required/>\n\t\t\t\t\t\t<span class="error-label"></span>\n\t\t\t\t\t</label>\n\t\t\t\t\t<button class="form__button form__button--submit button--main" id="login-submitBtn" type="submit" name="submit">Войти</button>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t\n\t\t<div class="modal" id="registration-modal">\n\t\t\t<div class="modal__body">\n\t\t\t\t<div class="modal__head">\n\t\t\t\t\t<button class="modal__close-button"></button>\n\t\t\t\t</div>\n\t\t\t\t<div class="modal__content" id="registration-section">\n\t\t\t\t\t<form class="hero__form form" id="registration-form" action="#" method="post" autocomplete="off">\n\t\t\t\t\t\t<label class="form__label form__label--email" for="registration-email">\n\t\t\t\t\t\t\t<input class="form__input form__input--email" id="registration-email" type="email" name="email" placeholder="Введите e-mail" required>\n\t\t\t\t\t\t\t<span class="error-label"></span>\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t<label class="form__label form__label--password" for="registration-password">\n\t\t\t\t\t\t\t<input class="form__input form__input--password" id="registration-password" type="password" name="password" placeholder="Введите пароль" required/>\n\t\t\t\t\t\t\t<span class="error-label"></span>\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t<label class="form__label form__label--repeat-password" for="registration-repeat-password">\n\t\t\t\t\t\t\t<input class="form__input form__input--repeat-password" id="registration-repeat-password" type="password" name="repeat-password" placeholder="Повторите пароль" required/>\n\t\t\t\t\t\t\t<span class="error-label"></span>\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t<div class="form__checkbox-wrapper">\n\t\t\t\t\t\t<input class="form__input form__input--checkbox" type="checkbox" name="consent-checkbox" id="registration-consent-checkbox" value="consent-checkbox" required>\n\t\t\t\t\t\t<span class="error-label"></span>\n\t\t\t\t\t\t<label class="form__label form__label--checkbox" for="registration-consent-checkbox">Принимаю условия <a class="form__terms-link" href="#">обработки персональных данных</a>\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<button class="form__button form__button--submit button--main" id="registration-submitBtn" type="submit" name="submit">Зарегистрироваться</button>\n\t\t\t\t\t</form>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t'),i.renderComponent('\n\t\t<section class="benefits">\n\t\t\t<div class="container">\n\t\t\t\t<div class="benefits__body">\n\t\t\t\t\t<div class="benefits__illustration-img-wrapper">\n\t\t\t\t\t\t<picture>\n\t\t\t\t\t\t\t<source srcset="./img/benefits_illustration.webp" type="image/webp">\n\t\t\t\t\t\t\t<img class="benefits__pic" src="./img/benefits_illustration.png" alt="иллюстрация">\n\t\t\t\t\t\t</picture>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="benefits__content">\n\t\t\t\t\t\t<h2 class="benefits__title ">Наши преимущеcтва:</h2>\n\t\t\t\t\t\t<ul class="benefits__list">\n\t\t\t\t\t\t\t<li class="benefits__list-item">С&nbsp;каких устройств переходят</li>\n\t\t\t\t\t\t\t<li class="benefits__list-item">В&nbsp;какие дни активность выше</li>\n\t\t\t\t\t\t\t<li class="benefits__list-item">Отправим вам статистику на&nbsp;почту или&nbsp;telegram</li>\n\t\t\t\t\t\t\t<li class="benefits__list-item">Полный контроль ваших клиентов</li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t<button class="benefits__button button--main modal-button" data-target="registration-modal">Начать бесплатно</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</section>\n  '))}const d="#body-section",u=".dropdown__button",m=".burger",p=".header__nav",_=".copy-button";document.addEventListener("click",(e=>{var n,o,s,r,l,a,i;if(e.target.closest(".logout-link")&&t.logout(),e.target.closest(u)&&e.target.nextElementSibling.classList.toggle("dropdown__list--visible"),e.target.closest(d)&&!e.target.matches(u)&&(null===(o=document.body.querySelector(u))||void 0===o||o.nextElementSibling.classList.remove("dropdown__list--visible")),e.target.closest(m)&&(e.target.classList.toggle("burger--active"),null===(s=document.querySelector(p))||void 0===s||s.classList.toggle("burger-menu--active"),document.body.classList.toggle("burger-menu-overlay")),e.target.closest(".nav__button")&&null!==(n=document.querySelector(m))&&void 0!==n&&n.classList.contains("burger--active")&&(null===(r=document.querySelector(m))||void 0===r||r.classList.remove("burger--active"),null===(l=document.querySelector(p))||void 0===l||l.classList.remove("burger-menu--active"),document.body.classList.remove("burger-menu-overlay")),!e.target.closest(d)||e.target.matches(m)||e.target.closest(".burger-menu--active")||(null===(a=document.querySelector(m))||void 0===a||a.classList.remove("burger--active"),null===(i=document.querySelector(p))||void 0===i||i.classList.remove("burger-menu--active"),document.body.classList.remove("burger-menu-overlay")),e.target.closest(d)&&document.querySelector(".modal--open")&&!e.target.closest(".modal__body")&&(document.querySelector(".modal--open").classList.remove("modal--open"),document.body.classList.remove("lock")),e.target.closest(".modal-button")){let t=e.target.getAttribute("data-target"),n=document.getElementById(t);null==n||n.classList.add("modal--open"),document.body.classList.add("lock")}e.target.closest(".modal__close-button")&&(document.querySelector(".modal--open").classList.remove("modal--open"),document.body.classList.remove("lock")),e.target.closest(_)&&(e.preventDefault(),document.querySelector(_).classList.add("checkmark"),async function(t){try{await navigator.clipboard.writeText(t),console.log("copied to clipboard")}catch(t){console.error(t)}}(e.target.closest(".form").querySelector(".short-link").value).then((()=>setTimeout((()=>document.querySelector(_).classList.remove("checkmark")),1e3))))}));const b=document.getElementById("preloader");function h(e){switch(e){case"#/":document.title="E-lnk",c();break;case"#/panel":document.title="Панель управления | E-lnk",async function(){t.accessToken?(r.renderComponent(s(t,"")),l.renderComponent("<h2>Панель управления</h2>")):c()}();break;case"#/settings":document.title="Настройки аккаунта | E-lnk",async function(){t.accessToken?(r.renderComponent(s(t,'<li class="nav__item"><a class="button--main" href="#/panel">Панель управления</a></li>',"")),l.renderComponent("<h2>Настройки аккаунта</h2>")):c()}()}}document.addEventListener("DOMContentLoaded",(async()=>{await t.refreshTokens(),0==window.location.hash.length?window.location.hash="#/":h(window.location.hash)})),window.addEventListener("hashchange",(()=>{document.body.classList.contains("burger-menu-overlay")&&document.body.classList.remove("burger-menu-overlay"),h(window.location.hash)})),document.addEventListener("readystatechange",(()=>{"complete"===document.readyState&&(null==b||b.classList.add("preloader--hide"),setTimeout((()=>b.style.display="none"),1e3))}));const v=h,g=document.getElementById("hero-section");function f(t){const e=document.getElementById("shortener-form"),o=document.getElementById("shortener-submitBtn"),s=document.getElementById("long-link"),r=document.getElementById("short-link"),l=document.querySelector(".hero__content"),a=document.querySelector(".form__input-wrapper--short-link"),i=document.querySelector(".hero__qr-body");t.preventDefault();let c=null==e?void 0:e.querySelectorAll("input"),d=!1;d=(c?Array.from(c).slice(0,-1):null).map((t=>y(t)&&n(s))).every((t=>!0===t)),d&&(o.classList.add("loader"),c.forEach((t=>t.setAttribute("disabled","disabled"))),w().then((()=>{o.classList.remove("loader"),c.forEach((t=>t.removeAttribute("disabled"))),s.value="",r.value&&(a.classList.add("open"),i.classList.add("open"),null==l||l.classList.add("open"))})))}function y(t){let e,n,o;return"longLink"===t.name&&(e=/^((ftp|http|https):\/\/)?(www\.)?([A-Za-zА-Яа-я0-9]{1}[A-Za-zА-Яа-я0-9\-]*\.?)*\.{1}[A-Za-zА-Яа-я0-9-]{2,8}(\/([\w#!:.?+=&%@!\-\/])*)?/.test(t.value)&&"."!==t.value.at(-1),n=t.value.includes("e-lnk.ru"),o="Введите корректный адрес ссылки"),e||""==t.value?n?(t.nextElementSibling.innerText="Это наша ссылка :) Введите другую",t.classList.add("error-input"),!1):(t.nextElementSibling.innerText="",t.classList.remove("error-input"),!0):(t.nextElementSibling.innerText=o,t.classList.add("error-input"),!1)}function C(){const t=document.getElementById("shortener-form");let e=null==t?void 0:t.querySelectorAll("input"),n=e?Array.from(e).slice(0,-1):null,o={};for(let t of n)t.value&&(o[t.name]=t.value);return o}async function w(){const e=document.getElementById("short-link"),n=document.getElementById("qr"),o={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json;charset=UTF-8",Authorization:t.accessToken?"Bearer ".concat(t.accessToken):""},body:JSON.stringify(C())};try{let s=await fetch("api/v1/links",o);if(401===s.status)return await t.refreshTokens()?w():void 0;let r=await s.json();console.log("Полученный json (shortener):"),console.log(r),r.shortLink&&r.qr?(e.value=r.shortLink,n.src="data:image/jpg;base64,".concat(r.qr)):r.error&&alert(r.error)}catch(t){alert("Не получилось сократить ссылку :( \nПожалуйста, попробуйте позже"),console.error("ошибка при запросе (shortener): "+t)}}new MutationObserver((t=>{const e=document.getElementById("shortener-form");if(e){e.setAttribute("novalidate",!0);let t=null==e?void 0:e.querySelectorAll("input"),n=t?Array.from(t).slice(0,-1):null;null==n||n.forEach((t=>{t.removeEventListener("blur",(()=>y(t))),t.removeEventListener("input",(()=>y(t)))})),null==e||e.removeEventListener("submit",f),null==n||n.forEach((t=>{t.addEventListener("blur",(()=>y(t))),t.addEventListener("input",(()=>y(t)))})),null==e||e.addEventListener("submit",f)}})).observe(g,{subtree:!0,childList:!0});const L=document.getElementById("modals-section");function k(){event.preventDefault();const e=document.getElementById("login-form"),s=null==e?void 0:e.querySelectorAll("input"),r=document.getElementById("login-submitBtn");let l=!1;l=Array.from(s).map((t=>o(t)&&n(t))).every((t=>!0===t)),l&&(r.classList.add("loader"),s.forEach((t=>t.setAttribute("disabled","disabled"))),async function(){const e={method:"POST",credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json;charset=UTF-8"},body:JSON.stringify(E())};try{let s=await fetch("api/v1/login",e),r=await s.json();var n,o;console.log("Полученный json (login_request):"),console.log(r),r.access?(t.email=r.email,t.accessToken=r.access,null===(n=document.querySelector(".modal--open"))||void 0===n||n.classList.remove("modal--open"),null===(o=document.querySelector("#body-section"))||void 0===o||o.classList.remove("lock"),v("#/")):r.error&&alert(r.error)}catch(t){alert("Не получилось выполнить вход :( \nПожалуйста, попробуйте позже"),console.error("ошибка при входе (login_request): "+t)}}().then((()=>{r.classList.remove("loader"),s.forEach((t=>t.removeAttribute("disabled"))),e.reset()})))}function E(){const t=document.getElementById("login-form"),e=null==t?void 0:t.querySelectorAll("input");let n={};for(let t of e)n[t.name]=t.value;return n}function q(){event.preventDefault();const s=document.getElementById("registration-form"),r=null==s?void 0:s.querySelectorAll("input"),l=document.getElementById("registration-submitBtn");let a=!1;a=Array.from(r).map((t=>o(t)&&n(t))).every((t=>!0===t)),a&&(l.classList.add("loader"),r.forEach((t=>t.setAttribute("disabled","disabled"))),async function(){const n={method:"POST",credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json;charset=UTF-8"},body:JSON.stringify(V())};try{let s=await fetch("api/v1/registration",n),r=await s.json();console.log("Полученный json (registration_request):"),console.log(r),r.access?(t.email=r.email,t.accessToken=r.access,new e("registration-section").renderComponent((o=t.email,'\n  <div class="success-registration">\n      <h2 class="success-registration__title">Вы успешно зарегестрированы!</h2>\n      <p class="success-registration__text">Чтобы начать пользоваться сервисом, перейдите по&nbsp;ссылке из&nbsp;письма в&nbsp;вашем почтовом ящике \n        <span class="success-registration__email">'.concat(o,"</span>\n      </p>\n  </div>\n  ")),[])):r.error&&alert(r.error)}catch(t){alert("Не получилось выполнить вход :( \nПожалуйста, попробуйте позже"),console.error("ошибка при регистрации (registration_request): "+t)}var o}().then((()=>{l.classList.remove("loader"),r.forEach((t=>t.removeAttribute("disabled"))),s.reset()})))}function V(){const t=document.getElementById("registration-form"),e=null==t?void 0:t.querySelectorAll("input");let n={};for(let t of e)"email"!==t.name&&"password"!=t.name||(n[t.name]=t.value);return n}new MutationObserver((t=>{const e=document.getElementById("login-form"),n=document.getElementById("registration-form");if(e){const t=null==e?void 0:e.querySelectorAll("input");null==e||e.setAttribute("novalidate",!0),null==t||t.forEach((t=>{t.removeEventListener("blur",(()=>o(t))),t.removeEventListener("input",(()=>o(t)))})),null==e||e.removeEventListener("submit",k),null==t||t.forEach((t=>{t.addEventListener("blur",(()=>o(t))),t.addEventListener("input",(()=>o(t)))})),null==e||e.addEventListener("submit",k)}if(n){const t=null==n?void 0:n.querySelectorAll("input");null==n||n.setAttribute("novalidate",!0),null==t||t.forEach((t=>{t.removeEventListener("blur",(()=>o(t))),t.removeEventListener("input",(()=>o(t)))})),null==n||n.removeEventListener("submit",q),null==t||t.forEach((t=>{t.addEventListener("blur",(()=>o(t))),t.addEventListener("input",(()=>o(t)))})),null==n||n.addEventListener("submit",q)}})).observe(L,{subtree:!0,childList:!0})})();